databaseChangeLog:
  - changeSet:
      id: 20240924013000_auto_designation2.yaml
      author: athiq
      changes:
        # Step 1: Attempt to drop the foreign key constraint, but it will not fail if it does not exist.
        - dropForeignKeyConstraint:
            constraintName: fk_designation_department
            baseTableName: department_designation

        # Step 2: Modify the data type and set auto-increment for designation id
        - modifyDataType:
            tableName: designation
            columnName: id
            newDataType: int
        - addAutoIncrement:
            columnName: id
            tableName: designation
            columnDataType: int

        # Step 3: Re-add the foreign key constraint
        - addForeignKeyConstraint:
            constraintName: fk_designation_department
            baseTableName: department_designation
            baseColumnNames: designation_id
            referencedTableName: designation
            referencedColumnNames: id

        # Step 4: Ensure the user foreign key is still added
        - addForeignKeyConstraint:
            constraintName: fk_user_designation
            baseTableName: user
            baseColumnNames: designation_id
            referencedTableName: designation
            referencedColumnNames: id
